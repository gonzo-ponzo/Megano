{% load static %}
{% load i18n %}
{% load category_tag %}

{% include 'templates/base.html' with title="Catalog" %}

<body class="Site">

  {% include 'templates/header.html' %}

  <div class="Middle Middle_top">

    <div class="Middle-top">
      <div class="wrap">
        <div class="Middle-header">
          <h1 class="Middle-title">
            <ul>
                <li class="breadcrumbs-item">
                    <a href="{% url 'catalog-page' %}">{% trans "Каталог Megano" %}</a>
                </li>
                {% for cat in parent_categories %}
                      <li class="breadcrumbs-item">
                          <a href="{% url 'category-catalog-page' cat.slug %}">
                              {{ cat.name }}
                          </a>
                      </li>
                {% endfor %}

            </ul>

          </h1>


          <ul class="breadcrumbs">
                {% for cat in child_categories %}
                    <li class="breadcrumbs-item">
                        <a href="{% url 'category-catalog-page' cat.slug %}">
                            {{ cat.name }}
                        </a>
                    </li>
                {% endfor %}
          </ul>

        </div>
      </div>
    </div>

    <div class="Section Section_column Section_columnLeft">
      <div class="wrap">

        <div class="Section-column">
          <div class="Section-columnSection">
            <header class="Section-header">
              <strong class="Section-title">{% trans "Фильтры" %}</strong>
            </header>
            <div class="Section-columnContent">

              <form class="form" action="#" method="get">
                <div class="form-group">
                  <div class="range Section-columnRange">
                    <input class="range-line" id="price" name="price" type="text" data-type="double" data-min="7" data-max="50"/>
                    <div class="range-price">{% trans 'Цена' %}:
                        <div class="rangePrice"></div>
                    </div>
                  </div>
                </div>
                <div class="form-group">
                  <input class="form-input form-input_full" id="title" name="title" type="text" placeholder="{% trans 'Название' %}"/>
                </div>
                <div class="form-group">
                  <select class="form-select">
                    <option value="seller" selected="selected" disabled="disabled">{% trans 'Продавец' %}</option>
                    <option value="kkk">Kkkk</option>
                    <option value="sdfsdf">sdfsdf</option>
                  </select>
                </div>
                <div class="form-group">
                  <label class="toggle">
                    <input type="checkbox"/><span class="toggle-box"></span><span class="toggle-text">{% trans 'Только товары в наличии' %}</span>
                  </label>
                </div>
                <div class="form-group">
                  <label class="toggle">
                    <input type="checkbox"/><span class="toggle-box"></span><span class="toggle-text">{% trans 'С бесплатной доставкой' %}</span>
                  </label>
                </div>
                <div class="form-group">
                  <div class="buttons">
                      <a class="btn btn_square btn_dark btn_narrow" href="#">OK</a>
                  </div>
                </div>
              </form>

            </div>
          </div>
          <div class="Section-columnSection">
            <header class="Section-header">
              <strong class="Section-title">Popular tags
              </strong>
            </header>
            <div class="Section-columnContent">
              <div class="buttons"><a class="btn btn_default btn_sm" href="#">Video</a><a class="btn btn_default btn_sm" href="#">Development</a><a class="btn btn_default btn_sm" href="#">Gaming</a><a class="btn btn_default btn_sm" href="#">Asus</a><a class="btn btn_default btn_sm" href="#">Development</a><a class="btn btn_default btn_sm" href="#">Video</a>
              </div>
            </div>
          </div>
        </div>


        <div class="Section-content">

          <div class="Sort">
            <div class="Sort-title">
                Сортировать по:
            </div>
            <div class="Sort-variants">

                {% for sort_item in sort_data %}
                    <a class="Sort-sortBy {{ sort_item.css_class }}" href="{{ request.path }}?{{ sort_item.arg_str }}">{{ sort_item.title|capfirst }}</a>
                {% endfor %}


            </div>
          </div>


          <div class="Cards">

            {% for product in product_list %}
                <div class="Card">

                    <a class="Card-picture" href="{{ product.get_absolute_url }}">
                        <img src=
                             {% if product.productimage_set.all %}
                                 "{{ product.productimage_set.all.0.image.url }}"
                             {% else %}
                                 "{% static 'img/no_image.png' %}"
                             {% endif %}
                        alt="{{ product.name|truncatechars:30 }}">
                    </a>

                    <div class="Card-content">
                        <strong class="Card-title">
                            <a href="{{ product.get_absolute_url }}">{{ product.name }}</a>
                        </strong>
                        <div class="Card-description">
                            <div class="Card-cost">
{#                                <span class="Card-priceOld">$115.00</span>#}
                                <span class="Card-price">
                                    {% if product.min_price > 0 %}
                                        от {{ product.min_price|floatformat:"0g" }} руб.
                                    {% else %}
                                        нет в продаже
                                    {% endif %}
                                </span>
                            </div>
                            <div class="Card-category">
                                <p>Заказов: {{ product.order_count }}</p>
                                {{ product.category }}
                            </div>
                            <div class="Card-hover">
                                <a class="Card-btn" href="#">
                                    <img src="{% static 'img/icons/card/change.svg' %}" alt="сравнить"/>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="Card-sale"><img src="{% static 'img/icons/star.svg' %}"> {{ product.rating }}</div>
                </div>
            {% endfor %}

          </div>

          <div class="Pagination">
            <div class="Pagination-ins">

                {% if page_obj.has_previous %}
                    <a class="Pagination-element Pagination-element_prev" href="?{% url_replace 'page' page_obj.previous_page_number %}"><img src="{% static 'img/icons/prevPagination.svg' %}" alt="prevPagination.svg"/></a>
                {% endif %}

                {% for page in paginator %}
                    {% if page.number == page_obj.number %}
                        <span class="Pagination-element Pagination-text Pagination-element_current">{{ page.number }}</span>
                    {% else %}
                        <a class="Pagination-element" href="?{% url_replace 'page' page.number %}"><span class="Pagination-text">{{ page.number }}</span></a>
                    {% endif %}
                {% endfor %}

                {% if page_obj.has_next %}
                    <a class="Pagination-element Pagination-element_prev" href="?{% url_replace 'page' page_obj.next_page_number %}"><img src="{% static 'img/icons/nextPagination.svg' %}" alt="nextPagination.svg"/></a>
                {% endif %}

            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
  {% include 'templates/footer.html' %}
  <script src="{% static 'plg/jQuery/jquery-3.5.0.slim.min.js' %}"></script>
  <script src="{% static 'plg/form/jquery.form.js' %}"></script>
  <script src="{% static 'plg/form/jquery.maskedinput.min.js' %}"></script>
  <script src="{% static 'plg/range/ion.rangeSlider.min.js' %}"></script>
  <script src="{% static 'plg/Slider/slick.min.js' %}"></script>
  <script src="{% static 'js/scripts.js' %}"></script>
</body>
